<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>

		<record id="vehicle_accesories_contact_filter" model="ir.ui.view">
			<field name="name">delsol.vehicle_accesories_contact.select</field>
			<field name="model">delsol.vehicle</field>
			<field name="inherit_id" ref="delsol_base.vehicle_filter"></field>
			<field name="arch" type="xml">
				<search>
					<field name="client_id" string="Cliente" />
					<separator />
					<group expand="1" string="Agrupar por">
						<filter string="Contactado por accesorios" name="accesory_contacted" domain="[ ]"
							context="{'group_by': 'accesories_contact'}" />
						<filter string="Accesorios instalados" name="accesory_installed" domain="[ ]"
							context="{'group_by': 'accesories_installed'}" />
					</group>

					<separator />
					<filter string="A Contactar por accesorios" name="accesories_contact" 
						domain="[('accesories_contact','=',False),('state','not in',('dispatched','delivered')),('vehicle_type','=','auto')]" />
				</search>                               
				
			</field>
		</record>

		<record id="vehicle_accesories_form" model="ir.ui.view">
			<field name="name">delsol.vehicle.accesories.form</field>
			<field name="model">delsol.vehicle</field>
			<field name="inherit_id" ref="delsol_base.vehicle_form"></field>
			<field name="arch" type="xml">
			
				<notebook position="inside">
					<page string="Accesorios" groups="accesorios.group_name_accesories_gestor">
						<field name="accesories_contact_ids" context="{'default_vehicle_id':id, 'default_client_id':client_id,'default_vehicle_model_id':modelo,'readonly_vehicle_id':True,'invisible_state_install':True}">
							<tree limit="5" create="1" delete="0">
								<field name="accesories_ids" />
								<field name="programmed_install_date" />
								<field name="state_install" />
								<field name="state" />
								<field name="annotations" />
							</tree>
						</field>
					</page>
				</notebook>
			</field>
		</record>


		<record id="vehicle_for_accesories_tree" model="ir.ui.view">
			<field name="name">delsol.vehicle.tree_for_accesories</field>
			<field name="model">delsol.vehicle</field>
			<field name="arch" type="xml">
				
				<tree string="Vehiculos" default_order="client_id desc" decoration-danger="priority_of_chequed_request=='high'">
					<field name="priority_of_chequed_request" invisible="1"/>
					<field name="delivery_id" invisible="1"/>
					<field name="name" string="Vehiculo"/>
					<field name="client_id" />
					<field name="state" />
					<field name="sector" />
					<field name="delivery_date" />
					<field name="accesories_contact" />
				</tree>
			</field>
		</record>

		<record id="open_view_accesories_contact_all" model="ir.actions.act_window">
			<field name="name">Clientes para ofrecer accesorios</field>
			<field name="res_model">delsol.vehicle</field>
			<field name="view_type">form</field>
			<field name="context">{
				'search_default_accesories_contact': 1,
				'search_default_priority': 1,				
				}
			</field>
			<field name="domain">[]</field>
			<field name="view_mode">tree,form</field>
		</record>

		<record model="ir.actions.act_window.view" id="custom_delsol_vehicle_tree_view_action">
            <field eval="2" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="vehicle_for_accesories_tree"/>
            <field name="act_window_id" ref="open_view_accesories_contact_all"/>
        </record>



	</data>
</openerp>